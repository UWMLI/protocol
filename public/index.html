<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>protocol</title>
		<script src="https://code.jquery.com/jquery-2.1.3.js"></script>
		<script src="/socket.io/socket.io.js"></script>
	</head>

	<body>
		<form action="">
			<input type="text"   id="message">
			<input type="submit" id="send">
		</form>

		<ul id="messages">
		</ul>

		<script>
			var socket = io();

			$('form').submit(function(event)
			{
				event.preventDefault();

				socket.emit('player message', $('#message').val());
				$('#message').val('');
			});

			socket.on('disconnect', function()
			{
				$('#messages').html('');

			});

			socket.on('player remove', function(player)
			{
				console.log("REMOVE");
				var player_element = "#"+player;
				$(player_element).remove();
			});

			socket.on('broadcast player message', function(player, message)
			{
				var player_element = "#"+player;

				if($(player_element).length > 0)
				{
					$(player_element).text("["+player+"] "+message);
				}
				else
				{
					$('#messages').append($('<li id='+player+'>').text("["+player+"]"+message));
				}
			});
		</script>
	</body>
</html>
